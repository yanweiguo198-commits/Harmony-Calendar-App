import reminderAgentManager from '@ohos.reminderAgentManager';
import notificationManager from '@ohos.notificationManager';

export class ReminderService {

  // å‘å¸ƒæé†’
  static async addReminder(title: string, targetTime: Date): Promise<number> {
    let reminder: reminderAgentManager.ReminderRequestCalendar = {
      reminderType: reminderAgentManager.ReminderType.REMINDER_TYPE_CALENDAR,
      dateTime: {
        year: targetTime.getFullYear(),
        month: targetTime.getMonth() + 1,
        day: targetTime.getDate(),
        hour: targetTime.getHours(),
        minute: targetTime.getMinutes(),
        second: 0
      },
      title: 'æ—¥ç¨‹æé†’',
      content: title,
      expiredContent: 'æ‚¨çš„æ—¥ç¨‹å·²è¿‡æœŸ',
      actionButton: [
        {
          title: 'å…³é—­',
          type: reminderAgentManager.ActionButtonType.ACTION_BUTTON_TYPE_CLOSE
        }
      ],
      snoozeTimes: 0,
      ringDuration: 5,
    }

    try {
      const reminderId = await reminderAgentManager.publishReminder(reminder);
      console.info('æé†’å‘å¸ƒæˆåŠŸ, ID: ' + reminderId);
      return reminderId;
    } catch (error) {
      console.error('æé†’å‘å¸ƒå¤±è´¥: ' + JSON.stringify(error));
      return -1;
    }
  }

  // ã€ğŸ‘‡ğŸ‘‡ğŸ‘‡ è¿™é‡Œæ˜¯è¡¥å›æ¥çš„ä»£ç  ğŸ‘‡ğŸ‘‡ğŸ‘‡ã€‘
  // å–æ¶ˆæé†’
  static async cancelReminder(reminderId: number) {
    if (reminderId >= 0) {
      try {
        await reminderAgentManager.cancelReminder(reminderId);
        console.info('æé†’å–æ¶ˆæˆåŠŸ ID:' + reminderId);
      } catch (error) {
        console.error('æé†’å–æ¶ˆå¤±è´¥: ' + JSON.stringify(error));
      }
    }
  }
}